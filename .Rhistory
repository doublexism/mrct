source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0,0.5,1),num_sim = 10,num_boot = 1000,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,3,4))
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0,0.5,1),num_sim = 10,num_boot = 1000,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,3,4))
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0,0.5,1),num_sim = 10,num_boot = 1000,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,3,4))
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result$sim_result
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0,0.5,1),num_sim = 100,num_boot = 100,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,3,4))
result$sim_result[[7]]
result$sim_result[[1]]
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0,0.5,1),num_sim = 100,num_boot = 100,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,3,4))
params <- paramGenerate(num_region = 2, prop_region = c(0.85,0.15),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(1,2),par1_arm2 = c(1,1),more_par = list(c(1,1),c(1,1)))
params <- paramGenerate(num_pat = 400, num_region = 2, prop_region = c(0.95,0.05),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(1,2),par1_arm2 = c(1,1),more_par = list(c(1,1),c(1,1)))
params
params <- paramGenerate(num_pat = 400, num_region = 2, prop_region = c(0.95,0.05),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(1,0),par1_arm2 = c(0,0),more_par = list(c(1,1),c(1,1)))
sim0.05 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =2,num_sim = 1000,num_boot = 1000)
sim0.05$LPP
sim0.05$BCICR
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
sim0.05 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =2,num_sim = 10,num_boot = 1000)
sim0.05
params <- paramGenerate(num_pat = 400, num_region = 2, prop_region = c(0.95,0.05),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(1,1),par1_arm2 = c(0,0),more_par = list(c(1,1),c(1,1)))
sim0.05 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =2,num_sim = 10,num_boot = 1000)
sim0.05
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0,0.5,1),num_sim = 100,num_boot = 100,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,3,4))
result
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
0.95/4
View(bootDiffMean)
View(bootDiffMean)
params <- paramGenerate(num_pat = 400, num_region = 2, prop_region = c(0.2375,0.2375,0.2375,0.2375,0.05),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(1,1,1,1,0),par1_arm2 = c(0,0,0,0,0),more_par = list(c(1,1,3,4,1),c(1,1,3,4,1)))
params <- paramGenerate(num_pat = 400, num_region = 5, prop_region = c(0.2375,0.2375,0.2375,0.2375,0.05),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(1,1,1,1,0),par1_arm2 = c(0,0,0,0,0),more_par = list(c(1,1,3,4,1),c(1,1,3,4,1)))
sim0.05 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =2,num_sim = 10,num_boot = 1000)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
sim0.05 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =2,num_sim = 10,num_boot = 1000)
View(params)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
sim0.05 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =2,num_sim = 10,num_boot = 1000)
View(sim0.05)
summary(sim0.05,mean)
summary(sim0.05,"mean")
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
sim0.05 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =5,num_sim = 10,num_boot = 1000)
BCICR
sim0.05$BCICR
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
sim0.05 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =5,num_sim = 10,num_boot = 1000)
params <- paramGenerate(num_pat = 400, num_region = 5, prop_region = c(0.2375,0.2375,0.2375,0.2375,0.05),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(1,1,1,1,0),par1_arm2 = c(0,0,0,0,0),more_par = list(c(1,1,1,1,1),c(1,1,1,1,1)))
sim0.05 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =5,num_sim = 10,num_boot = 1000)
params <- paramGenerate(num_region = 2, prop_region = c(0.90,0.10),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(1,2),par1_arm2 = c(1,1),more_par = list(c(1,1),c(1,1)))
params <- paramGenerate(num_pat = 400, num_region = 2, prop_region = c(0.95,0.05),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(1,2),par1_arm2 = c(1,1),more_par = list(c(1,1),c(1,1)))
sim0.15 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =2,num_pat = 400,num_sim = 1000,num_boot = 1000)
params <- paramGenerate(num_region = 2, prop_region = c(0.90,0.10),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(2,1),par1_arm2 = c(1,1),more_par = list(c(1,1),c(1,1)))
params <- paramGenerate(num_region = 2, prop_region = c(0.90,0.10),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(2,1),par1_arm2 = c(1,1),more_par = list(c(1,1),c(1,1)))
params <- paramGenerate(num_pat = 400, num_region = 2, prop_region = c(0.95,0.05),
num_arm = 2,
num_param = 2,name_param = c("Mean","SD"),
par1_arm1 = c(2,1),par1_arm2 = c(1,1),more_par = list(c(1,1),c(1,1)))
sim0.15 <- BCICR_sim(params = params,cutoff = seq(0.01,1,0.01),local =2,num_pat = 400,num_sim = 1000,num_boot = 1000)
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0,0.5,1),num_sim = 100,num_boot = 100,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,3,4))
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0),num_sim = 100,num_boot = 100,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,3,4))
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0),num_sim = 100,num_boot = 100,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,1,1))
result$sim_result
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 400,delta = c(0),num_sim = 100,num_boot = 1000,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,1,1,1))
result$sim_result
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
c(rbinom(100,1,0.1),rbinom(100,1,0.5),rbinom(100, 1,0.9))
x <- c(rbinom(100,1,0.1),rbinom(100,1,0.5),rbinom(100, 1,0.9))
var(x)
mean(x)
w <- rmultinom(1000,300,0.1)
w <- rmultinom(1000,1,0.1)
w <- rmultinom(n = 1000,300,0.1)
w <- rmultinom(1000,300,0.1)
w <- rmultinom(n = 1000,300,rep(0.1,300))
(x %*% w)/300
(x %*% w)/300 %>% var()
c((x %*% w)/300 )
mean <- c((x %*% w)/300 )
var(mean)
0.25/sqrt(300)
0.25/300
rbinom(1,20,0.17)
rbinom(1,20,0.17)
rbinom(1,20,0.17)
rbinom(1,20,0.17)
rbinom(1,20,0.17)
rbinom(1,20,0.17)
rbinom(1,20,0.17)
rbinom(1,20,0.17)
rbinom(1,20,0.17)
rbinom(100,20,0.17)
rbinom(100,20,0.17)/20
sum(rbinom(100,20,0.17) <2)
sum(rbinom(100,20,0.17) ==1)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 200,delta = c(0),num_sim = 100,num_boot = 1000,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 200,delta = c(0),num_sim = 100,num_boot = 1000,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 200,delta = c(0),num_sim = 100,num_boot = 1000,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
result$scenarios
result$sim_result
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
print(local_CI)
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 200,delta = c(0),num_sim = 100,num_boot = 1000,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 200,delta = c(0),num_sim = 100,num_boot = 1000,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 200,delta = c(0),num_sim = 10,num_boot = 1000,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
200*0.05
rbinom(1,5,0.1)
rbinom(1,5,0.4)
rbinom(1,5,0.4)
rbinom(1,5,0.4)
rbinom(1,5,0.4)
rbinom(1,5,0.4)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
rbinom(1,5,0.1)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 200,delta = c(0),num_sim = 10,num_boot = 100,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 200,delta = c(0),num_sim = 10,num_boot = 100,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05, 0.10, 0.15),sample_size = 200,delta = c(0),num_sim = 10,num_boot = 100,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
result <- scenarios_sim(prop_local = c(0.05),sample_size = 200,delta = c(0),num_sim = 10,num_boot = 100,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
result <- rmultinom(1000,10,rep(1/10))
result <- rmultinom(1000,10,rep(1/10,10))
View(result)
colSums(result[1:5,])
colSums(result[1:5,]) %>% table()
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result <- scenarios_sim(prop_local = c(0.05),sample_size = 200,delta = c(0),num_sim = 10,num_boot = 100,type = "binary",unequal_var = FALSE,unequal_eff = FALSE,treatment_rate = 0.4,control_rate = 0.1)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
1.23244*7
1.23244*9
1.23244*5
1/42
1.6316667*3
1.6316667*6
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result1 <- scenarios_sim(prop_local = c(0.05, 0.10,0.15,0.20),sample_size = 400,delta = c(0,0.2,0.4,0.6,0.8,1),num_sim = 1000,num_boot = 1000,type = "continuous",unequal_var = FALSE,unequal_eff = TRUE,NL_delta = c(1,0,1,0))
result2 <- scenarios_sim(prop_local = c(0.05, 0.10,0.15,0.20),sample_size = 400,delta = c(0,0.2,0.4,0.6,0.8,1),num_sim = 1000,num_boot = 1000,type = "continuous",unequal_var = TRUE,unequal_eff = FALSE,NL_var = c(1,3,3,1))
result3 <- scenarios_sim(prop_local = c(0.05, 0.10,0.15,0.20),sample_size = 400,delta = c(0,0.2,0.4,0.6,0.8,1),num_sim = 1000,num_boot = 1000,type = "continuous",unequal_var = TRUE,unequal_eff = TRUE,NL_var = c(1,3,3,1),NL_delta = c(1,0,1,0))
max(NA,0)
max(NA,0,na.rm = TRUE)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
bootCover(LCI = c(0,0),NLCI(0,1))
bootCover(LCI = c(0,0),NLCI=c(0,1))
params <- paramGenerate(num_region = 4, prop_region = c(0.25,0.25,0.25,0.25),
num_arm = 2,
num_param = 1,name_param = c("ORR"),
par1_arm1 = c(0.25,0.25,0.25,0.15),par1_arm2 = c(0.1,0.1,0.1,0.1))
params <- paramGenerate(num_pat = 400, num_region = 4, prop_region = c(0.25,0.25,0.25,0.25),
num_arm = 2,
num_param = 1,name_param = c("ORR"),
par1_arm1 = c(0.25,0.25,0.25,0.15),par1_arm2 = c(0.1,0.1,0.1,0.1))
dat <- simulate(params = params,sim_func = sim.binary)
summary(dat, "mean")
params <- paramGenerate(num_pat = 400, num_region = 4, prop_region = c(0.25,0.25,0.25,0.25),
num_arm = 2,
num_param = 1,name_param = c("ORR"),
par1_arm1 = c(0.25,0.25,0.25,0.15),par1_arm2 = c(0.1,0.1,0.1,0.1))
dat <- simulate(params = params,sim_func = sim.binary)
summary(dat, "mean")
dat <- simulate(params = params,sim_func = sim.binary)
summary(dat, "mean")
dat <- simulate(params = params,sim_func = sim.binary)
summary(dat, "mean")
bootDiffMean(dat, weight  = 1, control = 2, treatment = 1)
bootDiffMean(dat, weight  = bootWeighting(1000, dat, 400), control = 2, treatment = 1)
diff <- bootDiffMean(dat, weight  = bootWeighting(1000, dat, 400), control = 2, treatment = 1)
any(diff < 1)
any(diff < 0)
any(diff > 1)
params <- paramGenerate(num_pat = 400, num_region = 4, prop_region = c(0.35,0.30,0.30,0.05),
num_arm = 2,
num_param = 1,name_param = c("ORR"),
par1_arm1 = c(0.25,0.25,0.25,0.15),par1_arm2 = c(0.1,0.1,0.1,0.1))
dat <- simulate(params = params,sim_func = sim.binary)
diff <- bootDiffMean(dat, weight  = bootWeighting(1000, dat, 400), control = 2, treatment = 1)
any(diff <0)
hist(diff)
diff <- bootDiffMean(dat[Region ==4], weight  = bootWeighting(1000, dat[Region ==4], 400), control = 2, treatment = 1)
diff <- bootDiffMean(dat[dat$Region ==4], weight  = bootWeighting(1000, dat[dat$Region ==4], 400), control = 2, treatment = 1)
diff <- bootDiffMean(dat[dat$Region ==4,], weight  = bootWeighting(1000, dat[dat$Region ==4,], 400), control = 2, treatment = 1)
hist(diff)
summary(dat, "mean")
dat <- simulate(params = params,sim_func = sim.binary)
summary(dat, "mean")
diff <- bootDiffMean(dat[dat$Region ==4,], weight  = bootWeighting(1000, dat[dat$Region ==4,], 400), control = 2, treatment = 1)
hist(diff)
dat <- simulate(params = params,sim_func = sim.binary)
summary(dat, "mean")
diff <- bootDiffMean(dat[dat$Region ==4,], weight  = bootWeighting(1000, dat[dat$Region ==4,], 400), control = 2, treatment = 1)
hist(diff)
any(hist > 1)
any(diff > 1)
400*0.05
diff <- bootDiffMean(dat[dat$Region =\!=4,], weight  = bootWeighting(1000, dat[dat$Region !=4,], 20), control = 2, treatment = 1)
diff <- bootDiffMean(dat[dat$Region !=4,], weight  = bootWeighting(1000, dat[dat$Region !=4,], 20), control = 2, treatment = 1)
diff
hist(diff)
any(diff > 1)
which(diff > 1)
weight <- bootWeighting(1000, dat[dat$Region !=4,], 20)
diff <- bootDiffMean(dat[dat$Region !=4,], weight  = weigth, control = 2, treatment = 1)
diff <- bootDiffMean(dat[dat$Region !=4,], weight  = weight, control = 2, treatment = 1)
any(diff > 1)
weight <- bootWeighting(1000, dat[dat$Region !=4,], 20)
diff <- bootDiffMean(dat[dat$Region !=4,], weight  = weight, control = 2, treatment = 1)
any(diff > 1)
which(diff > 1)
w <- weight[,25]
w
v <- dat$value[dat$Region !=4]
v
v * weight
v * w
sum(v*w)
sum(v)
sum(w)
i <- dat[Region != 4]$Arm == 1
i <- dat[dat$Region != 4]$Arm == 1
i <- dat[dat$Region != 4,]$Arm == 1
i <- 2*dat[dat$Region != 4,]$Arm == 1
i <- 2*dat[dat$Region != 4,]$Arm == 1 -1
i <- 2*(dat[dat$Region != 4,]$Arm == 1) -1
i
v[i == 1]
v
v[i == -1]
sum(v[i == 1]*w[i==1])
sum(v[i == -1]*w[i==-1])
sum(w[i==-1])
sum(w[i==1])
diff[25]
10/13
10/13 - 0
colSums(weight)
colSums(weight[i == 1,])
colSums(weight[i == 1,])[25]
weight2 = weight * i
View(weight)
weight[,1]
weight2[,1]
weight2[1,]
w[i == 1]/sum(w[i ==1,])
w[i == 1]/sum(w[i ==1])
w[i == 1]/sum(w[i ==1]) %>% sum()
sum(w[i == 1]/sum(w[i ==1]))
w[i==1] <- w[i == 1]/sum(w[i ==1])
w[i==-1] <- w[i == -1]/sum(w[i ==-1])
sum(w)
w
w <- w*i
w
v %*% w
diff[25]
w <- weight[,25]
v <- dat[dat$Region == 4,]$Value
i <- 2*(dat[dat$Region == 4,]$Arm ==1)-1
w[i == 1,] <- w[i == 1,]/colSums(w[i==1,])
w[i == -1,] <- w[i == -1,]/colSums(w[i==-1,])
w <- w * i
boot_diff <- c(v %*% w)
w[i == 1] <- w[i == 1]/colSums(w[i==1])
w[i == -1] <- w[i == -1]/colSums(w[i==-1])
w <- w * i
boot_diff <- c(v %*% w)
v <- dat[dat$Region == 4,]$value
i <- 2*(dat[dat$Region == 4,]$Arm ==1)-1
w[i == 1] <- w[i == 1]/colSums(w[i==1])
w[i == 1] <- w[i == 1]/sum(w[i==1])
w[i == -1] <- w[i == -1]/sum(w[i==-1])
w <- w * i
boot_diff <- c(v %*% w)
v <- dat[dat$Region != 4,]$value
i <- 2*(dat[dat$Region != 4,]$Arm ==1)-1
w[i == 1] <- w[i == 1]/sum(w[i==1])
w[i == -1] <- w[i == -1]/sum(w[i==-1])
w <- w * i
boot_diff <- c(v %*% w)
v
w <- weight[,25]
v <- dat[dat$Region != 4,]$value
i <- 2*(dat[dat$Region != 4,]$Arm ==1)-1
w[i == 1] <- w[i == 1]/sum(w[i==1])
w[i == -1] <- w[i == -1]/sum(w[i==-1])
w <- w * i
boot_diff <- c(v %*% w)
w <- weight[,25]
v <- dat[dat$Region != 4,]$value
i <- 2*(dat[dat$Region != 4,]$Arm ==1)-1
w[i == 1] <- w[i == 1]/sum(w[i==1])
w[i == -1] <- w[i == -1]/sum(w[i==-1])
w <- w * i
boot_diff <- c(v %*% w)
w <- weight[,1:25]
v <- dat[dat$Region != 4,]$value
i <- 2*(dat[dat$Region != 4,]$Arm ==1)-1
w[i == 1,] <- w[i == 1,]/colSums(w[i==1,])
w[i == -1,] <- w[i == -1,]/colSums(w[i==-1,])
w <- w * i
boot_diff <- c(v %*% w)
boot_diff
w <- weight[,1:25]
v <- dat[dat$Region != 4,]$value
i <- 2*(dat[dat$Region != 4,]$Arm ==1)-1
colSums(w[i==1,])
colSums(w[i==-1,])
w[i == 1,] <- w[i == 1,]/colSums(w[i==1,])
w[i == -1,] <- w[i == -1,]/colSums(w[i==-1,])
colSums(w[i==-1,])
w <- weight[,1:25]
v <- dat[dat$Region != 4,]$value
i <- 2*(dat[dat$Region != 4,]$Arm ==1)-1
w
View(w)
colSums(w[i==1,])
colSums(w[i==-1,])
w[i == 1,] <- w[i == 1,]/colSums(w[i==1,])
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
w[i == 1,] <- w[i == 1,]%*% diag(1/colSums(w[i==1,]))
w[i == -1,] <- w[i == -1,] %*% diag(1/colSums(w[i==-1,]))
w <- w * i
w <- weight[,1:25]
v <- dat[dat$Region != 4,]$value
i <- 2*(dat[dat$Region != 4,]$Arm ==1)-1
w[i == 1,] <- w[i == 1,]%*% diag(1/colSums(w[i==1,]))
w[i == -1,] <- w[i == -1,] %*% diag(1/colSums(w[i==-1,]))
colSums(w[i==1,])
w <- w * i
boot_diff <- c(v %*% w)
boot_diff
diff <- bootDiffMean(dat[dat$Region !=4,], weight  = weight, control = 2, treatment = 1)
any(diff > 1)
hist(diff)
max(diff)
min(diff)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result4 <- scenarios_sim(prop_local = c(0.05),sample_size = 400,delta = c(0),num_sim = 100,num_boot = 1000,type = "binary",treatment_rate = 0.4,control_rate = 0.1)
result4$scenarios
result4$sim_result
result4 <- scenarios_sim(prop_local = c(0.5),sample_size = 400,delta = c(0),num_sim = 100,num_boot = 1000,type = "binary",treatment_rate = 0.4,control_rate = 0.1)
result4$sim_result
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
1.15 ** 28
1.15 ** 5
1.25 ** 5
1.25 ** 3
24200 * 3
14700*3
17400*3
9000 *3
11000*3
33.4+13.5
(33.4+13.5)*3
(33.4+13.5)*1.15
(33.4+13.5)*1.15*1.15
(33.4+13.5)*1.25*1.25
(33.4+13.5)*1.15**9
exp(log(10)/10)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result1$sim_result[[1]]$BCICR
result1$sim_result[[1]]$LPP
result1$scenarios
result1$sim_result[[21]]$LPP
result1$sim_result[[24]]$LPP
result1$sim_result[[4]]$LPP
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result1 <- scenarios_sim(prop_local = c(0.05),sample_size = 400,delta = c(0,1),num_sim = 100,num_boot = 1000,type = "continuous",unequal_var = FALSE,unequal_eff = TRUE,NL_delta = c(1,0,1,0))
result1$scenarios
result1$sim_result[[1]]$BCICR
result1$sim_result[[2]]$BCICR
result1$sim_result[[2]]$LPP
result1$sim_result[[1]]$LPP
result1$sim_result[[1]]$LPP
result1$sim_result[[2]]$LPP
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
View(result_sum)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
result1$sim_result[[1]]
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result1 <- scenarios_sim(prop_local = c(0.05, 0.10,0.15,0.20),sample_size = 400,delta = c(0,0.2,0.4,0.6,0.8,1),num_sim = 1000,num_boot = 1000,type = "continuous",unequal_var = FALSE,unequal_eff = TRUE,NL_delta = c(1,0,1,0))
map(list(list(a = 1,b=2)),`[[`)
map(list(list(a = 1,b=2)),`[[`(1))
map(list(list(a = 1,b=2)),`[[`(,1))
map(list(list(a = 1,b=2)),~`[[`(.,1))
list(list(a = 1,b=2)
)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
result_sum <- simResult(result1, result2,result3) %>% c
result_sum <- simResult(result1, result2,result3) %>% do.call(c,.)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
x <- getListElement(result_sum,"LPP")
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
result_sum <- simResult(result1, result2,result3)
View(result_sum)
subset_dat <- result_sum[result_sum$cutoff %in% c(0.1,0.2,0.3,0.4,0.5),]
View(subset_dat)
source('C:/Users/xiao.xiang/OneDrive - BeiGene/Codes/MRCT/scripts/functions.R')
